/****EXTRACTS COUNTY DEMOGRAPHIC DATA TO USE WITH pums****/

/*********************************************************/
/*Program adds 2002 and 2007 data to the EFFECT97 set in the effect library below.
This involves first making a 2002 subset commensurate in type to the 2007 subset.
We then need to make the Costat match the EFFECT97 set to the extent possible*/

LIBNAME IN1 'Z:\PublicFinance\Data\Demographics\Counties\COSTATS08\Data\';
libname effect 'Z:\PublicFinance\Data\Government Finances\TELS\LOCAL\DATA\';

/*Corrected for 2002 variables, or the most recent*/
	DATA X2002;
  SET IN1.COSTAT08;
  YEAR =2002;
  KEEP STCOU YEAR
         HSG495200D           IPE010202D           PEN020202D            PST045202D
         IPE120202D           SPR010202D           SPR030202D            EMN010202D
         AGE290202D           AGE770202D           LOG315202D            LOG310202D 
         LOG130202D           LOG010202D           LOG220202D            LOG230202D
         LND110200D           HSD310200D           HSG170200D            HSG030200D
         HSG045200D           HSG190200D           EDU364200D            EDU362200D
         EDU010202D           EMN260202D           EMN240202D;
 /*MUST GET MDHOMEVAL FROM MIKESELL'S DATA SET FOR 2005...NOTE ONLY 780 COUNTIES OR CALCULATE IN DATA SET*/
 /*ALSO, UPDATE GOV FINDATA, IT ENDS AT 2002 HERE*/
  RENAME HSG495200D=MDHOMEVAL IPE010202D=MED_INC   PEN020202D=PC_INC     PST045202D=RES_POP
         IPE120202D=PERS_POVT SPR010202D=SS_PERS   SPR030202D=SS_PMT     EMN010202D=TOT_EMP
         AGE290202D=POP_TH18  AGE770202D=POP_OV65  LOG315202D=PC_GEN_EXP LOG310202D=D_GEN_EXP 
         LOG130202D=IGR_ST    LOG010202D=GEN_REV   LOG220202D=TAX_REV    LOG230202D=PT_REV
         LND110200D=LANDAREA  HSD310200D=HSLD_PERS HSG170200D=PRE_1940   HSG030200D=HSG_UNITS
         HSG045200D=CH_HS_UNT HSG190200D=VACANT    EDU364200D=PVT_SCHL   EDU362200D=PUB_SCHL
         EDU015202D=T_PUB_SCH EMN260202D=RETL_EMP  EMN240202D=MFG_EMP;

	*PROC CONTENTS; *PROC PRINT;
	RUN;

DATA X2007;
  SET IN1.COSTAT08;
  YEAR =2007;
  KEEP STCOU YEAR
         HSG495200D           IPE010205D           PEN020206D            PST045207D
         IPE120205D           SPR010206D           SPR030206D            EMN010206D
         AGE290206D           AGE770206D           LOG315202D            LOG310202D 
         LOG130202D           LOG010202D           LOG220202D            LOG230202D
         LND110200D           HSD310200D           HSG170200D            HSG030200D
         HSG045200D           HSG190200D           EDU364200D            EDU362200D
         EDU015205D           EMN260206D           EMN240206D;
 /*MUST GET MDHOMEVAL FROM MIKESELL'S DATA SET FOR 2005...NOTE ONLY 780 COUNTIES OR CALCULATE IN DATA SET*/
 /*ALSO, UPDATE GOV FINDATA, IT ENDS AT 2002 HERE*/
  RENAME HSG495200D=MDHOMEVAL IPE010205D=MED_INC   PEN020206D=PC_INC     PST045207D=RES_POP
         IPE120205D=PERS_POVT SPR010206D=SS_PERS   SPR030206D=SS_PMT     EMN010206D=TOT_EMP
         AGE290206D=POP_TH18  AGE770206D=POP_OV65  LOG315202D=PC_GEN_EXP LOG310202D=D_GEN_EXP 
         LOG130202D=IGR_ST    LOG010202D=GEN_REV   LOG220202D=TAX_REV    LOG230202D=PT_REV
         LND110200D=LANDAREA  HSD310200D=HSLD_PERS HSG170200D=PRE_1940   HSG030200D=HSG_UNITS
         HSG045200D=CH_HS_UNT HSG190200D=VACANT    EDU364200D=PVT_SCHL   EDU362200D=PUB_SCHL
         EDU015205D=T_PUB_SCH EMN260206D=RETL_EMP  EMN240206D=MFG_EMP;

	*PROC CONTENTS; *PROC PRINT;
	RUN;


	proc contents data=effect.effect97;
	run;